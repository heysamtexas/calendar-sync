{% csrf_token %}
<div id="calendar-{{ calendar.id }}-status" 
     class="calendar-sync-toggle" 
     role="region" 
     aria-label="Sync settings for {{ calendar.name }}">
     
    <form class="sync-toggle-form" method="post">
        {% csrf_token %}
        
        <div class="sync-status-container">
            <span id="sync-status-{{ calendar.id }}" 
                  class="sync-status"
                  aria-live="polite">
                {% if calendar.sync_enabled %}
                    <span class="status status-active" aria-label="Sync is enabled">
                        <i class="icon-sync" aria-hidden="true"></i>
                        Enabled
                    </span>
                {% else %}
                    <span class="status status-inactive" aria-label="Sync is disabled">
                        <i class="icon-pause" aria-hidden="true"></i>
                        Disabled
                    </span>
                {% endif %}
            </span>
            
            <button type="button"
                    id="toggle-{{ calendar.id }}"
                    class="btn btn-toggle {% if calendar.sync_enabled %}btn-danger{% else %}btn-success{% endif %}"
                    hx-post="{% url 'dashboard:toggle_calendar_sync' calendar.id %}"
                    hx-target="closest td"
                    hx-swap="innerHTML"
                    hx-indicator="#loading-{{ calendar.id }}"
                    aria-describedby="sync-status-{{ calendar.id }}"
                    aria-label="{% if calendar.sync_enabled %}Disable{% else %}Enable{% endif %} sync for {{ calendar.name }}">
                    
                <span class="btn-text">
                    {% if calendar.sync_enabled %}
                        <i class="icon-pause" aria-hidden="true"></i>
                        Disable
                    {% else %}
                        <i class="icon-play" aria-hidden="true"></i>
                        Enable
                    {% endif %}
                </span>
            </button>
        </div>
        
        <!-- Loading indicator -->
        <div id="loading-{{ calendar.id }}" 
             class="loading-indicator htmx-indicator"
             role="status"
             aria-label="Updating sync settings">
            <span class="loading-spinner" aria-hidden="true"></span>
            <span class="loading-text">Updating...</span>
        </div>
        
        <!-- Error container -->
        <div id="error-{{ calendar.id }}" 
             class="error-container"
             role="alert"
             aria-live="assertive"
             style="display: none;">
        </div>
    </form>
</div>